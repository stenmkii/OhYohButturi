<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>原子物理・原子核 演習システム</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        .hidden { display: none; }
        .correct { color: #059669; font-weight: bold; }
        .incorrect { color: #dc2626; font-weight: bold; }
        .mjx-chtml { font-size: 110% !important; }
        input::placeholder { font-size: 0.9rem; color: #94a3b8; }
        .explanation-text { line-height: 1.8; }
        .math-tex { min-height: 1.2em; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">

<div id="app" class="max-w-3xl mx-auto p-4 md:p-8">
    <header class="mb-8 text-center">
        <h1 class="text-3xl font-bold text-slate-800">原子物理・原子核 演習</h1>
        <p class="text-slate-600 mt-2">全演習問題（15〜30）収録版</p>
    </header>

    <div id="menu" class="grid grid-cols-1 gap-4 mb-8">
        <button onclick="startSession(9)" class="bg-white p-4 rounded-xl shadow border-l-4 border-blue-500 text-left hover:bg-blue-50 transition">
            <h2 class="font-bold">第9回：原子の構造とスペクトル</h2>
            <p class="text-sm text-slate-500">公式 ＋ 演習15, 16</p>
        </button>
        <button onclick="startSession(10)" class="bg-white p-4 rounded-xl shadow border-l-4 border-green-500 text-left hover:bg-green-50 transition">
            <h2 class="font-bold">第10回：水素原子の定常状態</h2>
            <p class="text-sm text-slate-500">公式 ＋ 演習17〜20</p>
        </button>
        <button onclick="startSession(11)" class="bg-white p-4 rounded-xl shadow border-l-4 border-yellow-500 text-left hover:bg-yellow-50 transition">
            <h2 class="font-bold">第11回：構成粒子と同位体</h2>
            <p class="text-sm text-slate-500">演習21〜23</p>
        </button>
        <button onclick="startSession(12)" class="bg-white p-4 rounded-xl shadow border-l-4 border-red-500 text-left hover:bg-red-50 transition">
            <h2 class="font-bold">第12回：原子核の崩壊</h2>
            <p class="text-sm text-slate-500">公式 ＋ 演習24〜28</p>
        </button>
        <button onclick="startSession(13)" class="bg-white p-4 rounded-xl shadow border-l-4 border-purple-500 text-left hover:bg-purple-50 transition">
            <h2 class="font-bold">第13回：放射線の性質</h2>
            <p class="text-sm text-slate-500">演習29, 30</p>
        </button>
    </div>

    <div id="question-container" class="hidden bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
        <div class="flex justify-between items-center mb-4 border-b pb-2">
            <span id="question-title" class="text-sm font-bold text-blue-600 bg-blue-50 px-3 py-1 rounded-full"></span>
            <button onclick="backToMenu()" class="text-slate-400 hover:text-slate-600 text-sm">← 戻る</button>
        </div>
        
        <div id="question-text" class="text-slate-800 leading-relaxed mb-6 text-lg math-tex"></div>
        <div id="interaction-area" class="space-y-4"></div>
        <div id="feedback" class="mt-6 p-6 rounded-xl hidden border"></div>

        <div class="mt-8 flex justify-between">
            <button id="submit-btn" onclick="checkAnswer()" class="bg-blue-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-blue-700 shadow-lg transition">回答する</button>
            <button id="next-btn" onclick="nextQuestion()" class="hidden bg-slate-800 text-white px-8 py-3 rounded-xl font-bold hover:bg-slate-900 shadow-lg transition">次の問題へ</button>
        </div>
    </div>
</div>

<script>
const questions = [
    // --- 第9回 ---
    {
        id: "9-f1", session: 9, title: "第9回：公式確認",
        text: "光子のエネルギー $E$ を表す正しい式はどれですか？<br>($h$:プランク定数, $\\nu$:振動数, $c$:光速度, $\\lambda$:波長)",
        type: "select", options: ["$E = h\\nu = \\frac{hc}{\\lambda}$", "$E = \\frac{h}{\\nu} = \\frac{h\\lambda}{c}$", "$E = h\\lambda = \\frac{hc}{\\nu}$"],
        answer: "$E = h\\nu = \\frac{hc}{\\lambda}$", 
        explanation: "光子のエネルギーは振動数に比例します。$c = \\nu\\lambda$ より $\\nu = c/\\lambda$ なので、$E = h\\nu = hc/\\lambda$ です。"
    },
    {
        id: 15.1, session: 9, title: "演習15(1)",
        text: "原子核(原子番号 $Z$)から距離 $r$ の位置にある $\\alpha$ 粒子(電荷 $+2e$)の静電気力による位置エネルギー $U$ を求めよ。",
        type: "select", options: ["$k_0 \\frac{2Ze^2}{r}$", "$k_0 \\frac{Ze^2}{r}$", "$k_0 \\frac{2Ze^2}{r^2}$"],
        answer: "$k_0 \\frac{2Ze^2}{r}$",
        explanation: "$U = k_0 \\frac{q_1q_2}{r}$ より、$q_1=2e, q_2=Ze$ を代入します。"
    },
    {
        id: 15.3, session: 9, title: "演習15(3)",
        text: "$5.0 \\text{ MeV}$ の運動エネルギーを持った $\\alpha$ 粒子が金の原子($Z=79$)に入射するとき、もっとも近づける距離 $d \\text{ [m]}$ を求めよ。<br><small>$e=1.6\\times 10^{-19} \\text{ C}, k_0=9.0\\times 10^9, 1\\text{eV}=1.6\\times 10^{-19} \\text{ J}$</small>",
        type: "input", answer: "4.6e-14", unit: "m", digits: 2,
        explanation: "エネルギー保存則 $K = k_0 \\frac{2Ze^2}{d}$ より $d = \\frac{2k_0Ze^2}{K}$ です。"
    },
    {
        id: 16, session: 9, title: "演習16",
        text: "水素のスペクトルのうち、可視光領域にある系列を何というか。",
        type: "select", options: ["バルマー系列", "ライマン系列", "パッシェン系列"],
        answer: "バルマー系列",
        explanation: "ライマン系列は紫外、バルマーは可視、パッシェンは赤外領域です。"
    },
    // --- 第10回 ---
    {
        id: "10-f1", session: 10, title: "第10回：公式確認",
        text: "ボーアの量子条件として正しい式を選べ。",
        type: "select", options: ["$mvr = n\\frac{h}{2\\pi}$", "$2\\pi r = n\\frac{h}{mv}$", "両方正しい"],
        answer: "両方正しい",
        explanation: "角運動量の条件と、軌道一周がド・ブロイ波長の整数倍という条件は同値です。"
    },
    {
        id: 17, session: 10, title: "演習17",
        text: "水素原子の量子数 $n$ の軌道半径 $r_n$ は $n^2$ に比例するか。",
        type: "select", options: ["比例する", "反比例する", "関係ない"],
        answer: "比例する",
        explanation: "ボーアモデルより $r_n = \\frac{\\epsilon_0 h^2}{\\pi m e^2} n^2$ と導かれます。"
    },
    {
        id: 18.1, session: 10, title: "演習18(1)",
        text: "水素原子の基底状態($n=1$)のエネルギー $E_1 \\text{ [J]}$ はいくらか。<br><small>$h=6.6\\times 10^{-34}, c=3.0\\times 10^8, R=1.1\\times 10^7$</small>",
        type: "input", answer: "-2.2e-18", unit: "J", digits: 2,
        explanation: "$E_n = -\\frac{hcR}{n^2}$ に $n=1$ を代入。$E_1 \approx -2.178 \\times 10^{-18} \\text{ J}$。"
    },
    {
        id: 19, session: 10, title: "演習19",
        text: "水素原子を基底状態からイオン化（$n=\\infty$）するのに必要なエネルギー（イオン化エネルギー）は $E_1$ を用いてどう表せるか。",
        type: "select", options: ["$-E_1$", "$E_1$", "$0$"],
        answer: "$-E_1$",
        explanation: "$E_{\\infty} - E_1 = 0 - E_1 = -E_1$ です。$E_1$ 自体が負なので、全体で正のエネルギーが必要です。"
    },
    {
        id: 20, session: 10, title: "演習20",
        text: "基底状態の水素原子に $15 \\text{ eV}$ の光子を衝突させた。電子は放出されるか。",
        type: "select", options: ["放出される", "放出されない"],
        answer: "放出される",
        explanation: "イオン化エネルギーは約 $13.6 \\text{ eV}$ なので、それ以上のエネルギーを持つ光子を吸収すれば電子は飛び出します。"
    },
    // --- 第11回 ---
    {
        id: 21, session: 11, title: "演習21",
        text: "$^{27}_{13}\\text{Al}$ 原子核に含まれる中性子の数はいくつか。",
        type: "input", answer: "14", unit: "個", digits: 0,
        explanation: "質量数 $27$ - 原子番号 $13 = 14$ です。"
    },
    {
        id: 22, session: 11, title: "演習22",
        text: "原子番号が同じで、質量数が異なる原子同士を何というか。",
        type: "select", options: ["同位体（アイソトープ）", "同素体", "同重体"],
        answer: "同位体（アイソトープ）",
        explanation: "化学的性質はほぼ同じですが、中性子の数が異なります。"
    },
    {
        id: 23, session: 11, title: "演習23",
        text: "原子核を構成する陽子と中性子を総称して何というか。",
        type: "select", options: ["核子（ヌクレオン）", "光子", "電子"],
        answer: "核子（ヌクレオン）",
        explanation: "原子核（Nucleus）の構成員なのでヌクレオンです。"
    },
    // --- 第12回 ---
    {
        id: "12-f1", session: 12, title: "第12回：公式確認",
        text: "$\\beta$ 崩壊（負のベータ崩壊）の際、原子核内で何が起きているか。",
        type: "select", options: ["中性子が陽子と電子に変わる", "陽子が中性子と電子に変わる", "$\\alpha$ 粒子が放出される"],
        answer: "中性子が陽子と電子に変わる",
        explanation: "中性子が陽子に変わるため、質量数は変わらず、原子番号が $1$ 増えます。"
    },
    {
        id: 24, session: 12, title: "演習24",
        text: "$^{14}_{6}\\text{C}$ が $\\beta$ 崩壊してできる原子核はどれか。",
        type: "select", options: ["$^{14}_{7}\\text{N}$", "$^{10}_{4}\\text{Be}$", "$^{14}_{5}\\text{B}$"],
        answer: "$^{14}_{7}\\text{N}$",
        explanation: "原子番号が $6 \rightarrow 7$ に増えます。"
    },
    {
        id: 25, session: 12, title: "演習25",
        text: "$\\alpha$ 崩壊を1回行うと、質量数はいくつ減少するか。",
        type: "input", answer: "4", unit: "", digits: 0,
        explanation: "$\\alpha$ 粒子（ヘリウム核）は陽子2個、中性子2個なので質量数は $4$ 減ります。"
    },
    {
        id: 26, session: 12, title: "演習26",
        text: "$^{232}_{90}\\text{Th} \rightarrow ^{208}_{82}\\text{Pb}$ の過程で $\\beta$ 崩壊は何回起きるか。",
        type: "input", answer: "4", unit: "回", digits: 0,
        explanation: "$\\alpha$ 崩壊が6回起きて原子番号が $78$ になり、そこから $\\beta$ 崩壊で $82$ まで戻ります。"
    },
    {
        id: 27, session: 12, title: "演習27",
        text: "放射性物質の量が半分になる時間を何というか。",
        type: "select", options: ["半減期", "平均寿命", "活動期"],
        answer: "半減期",
        explanation: "その物質固有の定数です。"
    },
    {
        id: 28, session: 12, title: "演習28",
        text: "半減期が $T$ の物質が、時間 $3T$ 経過したとき、元の量の何倍になるか。",
        type: "select", options: ["$1/8$ 倍", "$1/6$ 倍", "$1/4$ 倍"],
        answer: "$1/8$ 倍",
        explanation: "$(1/2)^3 = 1/8$ です。"
    },
    // --- 第13回 ---
    {
        id: 29, session: 13, title: "演習29",
        text: "$^{14}\\text{C}$ の割合が $1/8$ の木片がある。年代を推定せよ。（半減期 $5700$ 年）",
        type: "input", answer: "1.7e4", unit: "年前", digits: 2,
        explanation: "$3 \times 5700 = 17100$ 年。"
    },
    {
        id: 30.1, session: 13, title: "演習30(1)",
        text: "電磁波である放射線はどれか。",
        type: "select", options: ["$\\gamma$ 線", "$\\alpha$ 線", "$\\beta$ 線"],
        answer: "$\\gamma$ 線",
        explanation: "$\\alpha$ はヘリウム核、$\\beta$ は電子の粒子線です。"
    },
    {
        id: 30.2, session: 13, title: "演習30(2)",
        text: "最も電離作用（物質をイオン化する力）が強いのはどれか。",
        type: "select", options: ["$\\alpha$ 線", "$\\beta$ 線", "$\\gamma$ 線"],
        answer: "$\\alpha$ 線",
        explanation: "電荷が大きく速度が遅いため、周囲の原子に強く干渉します。"
    }
];

let currentSessionQuestions = [];
let currentQuestionIndex = 0;

function startSession(sessionNum) {
    currentSessionQuestions = questions.filter(q => q.session === sessionNum);
    if (currentSessionQuestions.length === 0) {
        alert("準備中です。");
        return;
    }
    currentQuestionIndex = 0;
    document.getElementById('menu').classList.add('hidden');
    document.getElementById('question-container').classList.remove('hidden');
    showQuestion();
}

function showQuestion() {
    const q = currentSessionQuestions[currentQuestionIndex];
    document.getElementById('question-title').innerText = q.title;
    document.getElementById('question-text').innerHTML = q.text;
    document.getElementById('feedback').classList.add('hidden');
    document.getElementById('next-btn').classList.add('hidden');
    document.getElementById('submit-btn').classList.remove('hidden');

    const area = document.getElementById('interaction-area');
    area.innerHTML = '';

    if (q.type === 'select') {
        const shuffledOptions = [...q.options].sort(() => Math.random() - 0.5);
        shuffledOptions.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = "w-full text-left p-4 border-2 border-slate-200 rounded-xl hover:border-blue-400 transition mb-3 bg-white shadow-sm";
            btn.innerHTML = opt;
            btn.onclick = () => selectOption(btn, opt);
            area.appendChild(btn);
        });
        area.dataset.value = "";
    } else {
        const inputWrap = document.createElement('div');
        inputWrap.className = "flex items-center space-x-3";
        const input = document.createElement('input');
        input.type = "text";
        input.placeholder = "例: 2.0 x 10^5 → 2.0e-5";
        input.className = "flex-1 p-4 border-2 border-slate-200 rounded-xl focus:border-blue-500 outline-none text-xl font-mono";
        input.id = "user-input";
        inputWrap.appendChild(input);
        if (q.unit) {
            const unitLabel = document.createElement('span');
            unitLabel.className = "text-xl font-bold text-slate-600";
            unitLabel.innerText = q.unit;
            inputWrap.appendChild(unitLabel);
        }
        area.appendChild(inputWrap);
    }
    
    renderMath();
}

function renderMath() {
    if (window.MathJax && MathJax.typesetPromise) {
        setTimeout(() => {
            MathJax.typesetPromise([document.getElementById('question-container')]).catch(err => console.log(err));
        }, 50);
    }
}

function selectOption(btn, val) {
    const parent = btn.parentElement;
    Array.from(parent.children).forEach(c => {
        c.classList.remove('border-blue-500', 'bg-blue-50');
        c.classList.add('border-slate-200', 'bg-white');
    });
    btn.classList.replace('border-slate-200', 'border-blue-500');
    btn.classList.add('bg-blue-50');
    parent.dataset.value = val;
}

function checkAnswer() {
    const q = currentSessionQuestions[currentQuestionIndex];
    let isCorrect = false;
    let userVal = "";

    if (q.type === 'select') {
        userVal = document.getElementById('interaction-area').dataset.value;
        if (!userVal) { alert("選択してください"); return; }
        isCorrect = (userVal === q.answer);
    } else {
        const rawInput = document.getElementById('user-input').value.trim().toLowerCase();
        if (!rawInput) { alert("回答を入力してください"); return; }
        const userNum = parseFloat(rawInput);
        const expectedNum = parseFloat(q.answer);
        
        if (q.digits === 0) {
            isCorrect = (Math.abs(userNum - expectedNum) < 0.1);
        } else {
            const formattedUser = userNum.toExponential(q.digits - 1);
            const formattedExpected = expectedNum.toExponential(q.digits - 1);
            isCorrect = (formattedUser === formattedExpected);
        }
    }

    const feedback = document.getElementById('feedback');
    feedback.classList.remove('hidden');
    feedback.className = `mt-6 p-6 rounded-xl border ${isCorrect ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'}`;
    feedback.innerHTML = `
        <p class="text-xl mb-2 ${isCorrect ? 'correct' : 'incorrect'}">${isCorrect ? '✨ 正解！' : '❌ 不正解...'}</p>
        <p class="text-md text-slate-700 mb-4"><strong>正解:</strong> ${q.answer} ${q.unit || ''}</p>
        <div class="mt-4 text-slate-600 text-[0.95rem] explanation-text border-t border-slate-200 pt-4">
            <p class="font-bold text-slate-800 mb-2">【解説】</p>
            ${q.explanation}
        </div>
    `;

    document.getElementById('submit-btn').classList.add('hidden');
    document.getElementById('next-btn').classList.remove('hidden');
    
    renderMath();
}

function nextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < currentSessionQuestions.length) {
        showQuestion();
    } else {
        alert("このセッションを完了しました！メニューに戻ります。");
        backToMenu();
    }
}

function backToMenu() {
    document.getElementById('menu').classList.remove('hidden');
    document.getElementById('question-container').classList.add('hidden');
}
</script>
</body>
</html>